- name: "{{ testname }} - POST bitbucket push delete webhook with branch {{ branch }} and repo {{ bitbucket_git_repo }} to {{ webhook_url }}"
  uri:
    url: "{{ webhook_url }}"
    headers:
      User-Agent: Bitbucket-Webhooks/2.0
      X-Event-Key: repo:push
      X-Hook-Uuid: bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb
      X-Request-Uuid: cccccccc-cccc-cccc-cccccccccccc
      content-type: application/json
    method: POST
    follow_redirects: yes
    body_format: json
    body: '{"push":{"changes":[{"forced":false,"old":{"type":"branch","name":"{{ branch }}","links":{"commits":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commits/testingbranch"},"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/refs/branches/testingbranch"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/branch/testingbranch"}},"target":{"hash":"a85865934d40efcc7d3129564860993b7777e6e4","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/a85865934d40efcc7d3129564860993b7777e6e4"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/a85865934d40efcc7d3129564860993b7777e6e4"}},"author":{"raw":"Tyler Ward <twardnw@gmail.com>","type":"author","user":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}}},"parents":[{"type":"commit","hash":"6690f6b83e618624ae725f44f4f49e8b48ef52d5","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/6690f6b83e618624ae725f44f4f49e8b48ef52d5"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/6690f6b83e618624ae725f44f4f49e8b48ef52d5"}}}],"date":"2017-07-20T21:24:53+00:00","message":"pushy pushy\n","type":"commit"}},"truncated":false,"created":false,"closed":true,"new":null}]},"actor":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}},"repository":{"scm":"git","website":"","name":"amazeeio-site","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site"},"html":{"href":"{{ git_repo_url }}"},"avatar":{"href":"https://bitbucket.org/twardnw/amazeeio-site/avatar/32/"}},"full_name":"{{ git_repo_full_name }}","owner":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}},"type":"repository","is_private":true,"uuid":"{34d2ec16-e8eb-4223-a449-cdd6447db7ea}"}}'